<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sany Play Z Tv</title>
    <link href="https://vjs.zencdn.net/7.20.3/video-js.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.3.5/shaka-player.compiled.js"></script>
    <style>
        :root {
            --bg-dark: #000000;
            --surface: #0d0d0d;
            --border: rgba(255, 255, 255, 0.1);
            --primary: #ffffff;
        }

        body {
            background-color: var(--bg-dark);
            color: #fff;
            font-family: 'Hind Siliguri', sans-serif;
            margin: 0; padding: 0;
            overflow-x: hidden;
        }

        .sticky-top-area {
            position: sticky;
            top: 0;
            z-index: 1000;
            background: var(--bg-dark);
        }

        header {
            padding: 5px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border);
        }

        /* ‡¶≤‡ßç‡¶Ø‡¶æ‡¶™‡¶ü‡¶™ ‡¶∞‡ßá‡¶ú‡ßã‡¶≤‡¶ø‡¶â‡¶∂‡¶® (1366x768) ‡¶´‡¶ø‡¶ï‡ßç‡¶∏ */
        .video-box {
            background: #000;
            position: relative;
            width: 100%;
            max-width: 850px; /* ‡¶≤‡ßç‡¶Ø‡¶æ‡¶™‡¶ü‡¶™‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶™‡ßç‡¶≤‡ßá‡ßü‡¶æ‡¶∞ ‡¶è‡¶ï‡¶ü‡ßÅ ‡¶õ‡ßã‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá */
            margin: 0 auto;
            aspect-ratio: 16 / 9;
            max-height: 60vh; /* ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡ßá‡¶∞ ‡ß¨‡ß¶% ‡¶è‡¶∞ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶≤‡¶Æ‡ßç‡¶¨‡¶æ ‡¶π‡¶¨‡ßá ‡¶®‡¶æ */
        }

        #vjs-player, #shaka-player, #iframe-player {
            width: 100% !important;
            height: 100% !important;
            object-fit: contain;
        }

        .info-slider {
            background: #ffffff; 
            color: #000;
            padding: 3px 0;
            font-size: 12px;
            font-weight: 700;
            overflow: hidden;
            white-space: nowrap;
            border-bottom: 2px solid #ff0000;
        }

        .info-content {
            display: inline-block;
            animation: scroll-left 60s linear infinite;
        }

        @keyframes scroll-left {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 0 10px; 
        }

        .search-box-container { padding: 10px 0 5px 0; }
        
        #ch-search {
            width: 100%;
            padding: 10px 15px;
            background: #111;
            border: 1px solid #333;
            border-radius: 8px;
            color: #fff;
            font-size: 14px;
            outline: none;
            box-sizing: border-box;
        }

        .tabs { 
            display: flex; overflow-x: auto; gap: 8px; padding: 8px 0; 
            scrollbar-width: thin;
        }

        .tab {
            background: #141414; border: 1px solid #222; color: #888;
            padding: 6px 15px; border-radius: 20px; font-size: 12px; font-weight: 700;
            cursor: pointer; white-space: nowrap; transition: 0.3s;
        }
        .tab.active { background: #fff; color: #000; border-color: #fff; }

        /* ‡¶ó‡ßç‡¶∞‡¶ø‡¶° ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ: ‡¶≤‡ßç‡¶Ø‡¶æ‡¶™‡¶ü‡¶™‡ßá ‡¶Ø‡¶æ‡¶§‡ßá ‡¶Ö‡¶®‡ßá‡¶ï‡¶ó‡ßÅ‡¶≤‡ßã ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶è‡¶ï‡¶∏‡¶æ‡¶•‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶Ø‡¶æ‡ßü */
        .grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); 
            gap: 10px; 
            padding: 10px 0 30px 0; 
        }

        .item {
            background: var(--surface); border: 1px solid #1a1a1a; border-radius: 8px;
            padding: 10px 5px; text-align: center;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            cursor: pointer; transition: 0.2s;
            min-height: 100px;
        }
        
        .item:hover { border-color: #444; transform: translateY(-2px); }
        .item.active { background: #fff; }
        .item.active .ch-name { color: #000; }

        .ch-logo { width: 40px; height: 40px; object-fit: contain; margin-bottom: 5px; }
        .ch-name { font-size: 11px; font-weight: 700; color: #ccc; }

        /* ‡¶≤‡ßç‡¶Ø‡¶æ‡¶™‡¶ü‡¶™ ‡¶∞‡ßá‡¶ú‡ßã‡¶≤‡¶ø‡¶â‡¶∂‡¶®‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∏‡ßç‡¶™‡ßá‡¶∂‡¶æ‡¶≤ ‡¶Æ‡¶ø‡¶°‡¶ø‡ßü‡¶æ ‡¶ï‡ßÅ‡ßü‡ßá‡¶∞‡¶ø */
        @media (max-height: 800px) {
            .video-box { max-width: 700px; } /* ‡¶π‡¶æ‡¶á‡¶ü ‡¶ï‡¶Æ ‡¶π‡¶≤‡ßá ‡¶™‡ßç‡¶≤‡ßá‡ßü‡¶æ‡¶∞ ‡¶Ü‡¶∞‡¶ì ‡¶õ‡ßã‡¶ü ‡¶π‡¶¨‡ßá */
            header { padding: 2px 10px; }
            .logo { font-size: 14px; }
        }

        .server-switcher { display: flex; gap: 5px; background: #111; padding: 3px; border-radius: 50px; }
        .srv-btn {
            background: transparent; color: #666; border: none; padding: 4px 10px;
            border-radius: 50px; font-size: 11px; font-weight: 700; cursor: pointer;
        }
        .srv-btn.active { background: #fff; color: #000; }
    </style>
</head>
<body>

<div class="sticky-top-area">
    <header>
        <div class="logo">SANY PLAY Z <span style="font-weight: 300; opacity: 0.6;"üì∫</span></div>
        <div class="server-switcher">
            <button class="srv-btn" id="btn-srv-3" onclick="switchServer(3)">‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞ ‡ß©</button>
            <button class="srv-btn" id="btn-srv-2" onclick="switchServer(2)">‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞ ‡ß®</button>
            <button class="srv-btn" id="btn-srv-1" onclick="switchServer(1)">‡¶∏‡¶æ‡¶∞‡ßç‡¶≠‡¶æ‡¶∞ ‡ßß</button>
        </div>
    </header>
    
    <div class="video-box" id="player-container"></div>

    <div class="info-slider">
        <div class="info-content" id="sliding-info">‡¶§‡¶•‡ßç‡¶Ø ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
    </div>
</div>

<div class="container">
    <div class="search-box-container">
        <input type="text" id="ch-search" placeholder="‡¶∏‡¶æ‡¶∞‡ßç‡¶ö ‡¶ï‡¶∞‡ßÅ‡¶®..." onkeyup="filterChannels()">
    </div>
    <div class="tabs" id="tabs-list"></div>
    <div class="grid" id="grid-list">‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®...</div>
</div>

<script src="https://vjs.zencdn.net/7.20.3/video.min.js"></script>
<script>
    let currentServer = 2;
    let tvPlayer = null;
    let masterData = {};
    let currentRandomQuote = "";
    let lastActiveCategory = "";
    
    function pickRandomQuote() {
        currentRandomQuote = "‡¶∏‡¶æ‡¶´‡¶≤‡ßç‡¶Ø ‡¶§‡¶æ‡¶¶‡ßá‡¶∞‡¶á ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ø‡¶æ‡¶∞‡¶æ ‡¶∂‡ßá‡¶∑ ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶≤‡ßú‡¶æ‡¶á ‡¶ï‡¶∞‡ßá‡•§";
    }

    function updateSlidingInfo() {
        const now = new Date();
        const dateStr = now.toLocaleDateString('bn-BD', { day: 'numeric', month: 'long', year: 'numeric' });
        const timeStr = now.toLocaleTimeString('bn-BD');
        const fullText = `üìÖ ‡¶Ü‡¶ú ${dateStr} | üïí ‡¶∏‡¶Æ‡ßü: ${timeStr} | üí° ${currentRandomQuote}`;
        document.getElementById('sliding-info').innerHTML = `${fullText} &nbsp;&nbsp;&nbsp;&nbsp; [ ${fullText} ]`;
    }

    setInterval(updateSlidingInfo, 1000);

    const manualChannels = [
        { name: "T-Sports HD", url: "https://bongoflixbd.top/r/?watch=b0aeb53ec98c74b3b1bb5f16acf8f056", logo: "https://upload.wikimedia.org/wikipedia/en/2/2f/T_Sports_logo.png", category: "SPORTS", isIframe: true },
        { name: "Star Sports 1", url: "https://bongoflixbd.top/r/?watch=339dcfaa4f761b545a5b815ee54a9bad", logo: "üèè", category: "SPORTS", isIframe: true }
    ];

    const M3U_DISH = 'https://raw.githubusercontent.com/alex8875/m3u/refs/heads/main/dishtv.m3u';
    const M3U_MAIN = 'https://raw.githubusercontent.com/mdarif2743/Cmcl-digital-mpd/refs/heads/main/README.m3u';
    const M3U_BD = 'https://raw.githubusercontent.com/cctvccplc/Tv-Test/refs/heads/main/BD26.m3u8';    
    const M3U_SERVER3 = 'https://raw.githubusercontent.com/sm-monirulislam/RoarZone-Auto-Update-playlist/refs/heads/main/RoarZone.m3u';

    window.onload = () => {
        pickRandomQuote();
        switchServer(2);
    };

    async function switchServer(id) {
        currentServer = id;
        document.querySelectorAll('.srv-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(`btn-srv-${id}`).classList.add('active');
        masterData = {}; 
        
        if (tvPlayer && tvPlayer.dispose) { try{ tvPlayer.dispose(); } catch(e){} }
        const pContainer = document.getElementById('player-container');
        pContainer.innerHTML = '';

        if (id === 1) {
            pContainer.innerHTML = `<video id="shaka-player" controls autoplay></video>`;
            tvPlayer = new shaka.Player(document.getElementById('shaka-player'));
            await loadM3U(M3U_DISH);
        } else {
            pContainer.innerHTML = `<video id="vjs-player" class="video-js vjs-big-play-centered" controls preload="auto"></video><iframe id="iframe-player" style="display:none; width:100%; height:100%; border:none;" allowfullscreen></iframe>`;
            tvPlayer = videojs('vjs-player', { responsive: true, fluid: true });
            
            if (id === 2) {
                manualChannels.forEach(ch => addChannel(ch.category, ch));
                await loadServer2();
            } else if (id === 3) {
                await loadServer3();
            }
        }
    }

    async function loadM3U(url) {
        try {
            const res = await fetch(url);
            const text = await res.text();
            const lines = text.split('\n');
            let currentDRM = null;
            for (let i = 0; i < lines.length; i++) {
                let line = lines[i].trim();
                if (line.includes('license_key=')) {
                    let p = line.split('=')[1].split(':');
                    currentDRM = { [p[0].trim()]: p[1].trim() };
                } else if (line.startsWith('#EXTINF:')) {
                    let name = line.split(',')[1]?.trim() || "";
                    let logo = line.match(/tvg-logo="([^"]+)"/)?.[1] || "";
                    let group = line.match(/group-title="([^"]+)"/)?.[1]?.toUpperCase() || "OTHERS";
                    let chUrl = lines[i+1]?.trim();
                    if (chUrl && chUrl.startsWith('http')) {
                        addChannel(group, { name, logo, url: chUrl, drm: currentDRM });
                    }
                    currentDRM = null;
                }
            }
            renderTabs();
        } catch(e) {}
    }

    async function loadServer2() {
        try {
            const [r1, r2] = await Promise.all([
                fetch(M3U_MAIN).then(r=>r.text()).catch(()=>""), 
                fetch(M3U_BD).then(r=>r.text()).catch(()=>"")
            ]);
            parseS2(r1, false); parseS2(r2, true);
            renderTabs();
        } catch(e) {}
    }

    async function loadServer3() {
        try {
            const res = await fetch(M3U_SERVER3);
            const data = await res.text();
            parseS2(data, false);
            renderTabs();
        } catch(e) {}
    }

    function parseS2(data, isBd) {
        const lines = data.split('\n');
        let temp = null;
        lines.forEach(l => {
            if (l.includes('#EXTINF:')) {
                temp = { 
                    name: l.split(',')[1]?.trim() || "", 
                    logo: l.match(/tvg-logo="([^"]+)"/)?.[1], 
                    category: isBd ? "BANGLA" : (l.match(/group-title="([^"]+)"/)?.[1]?.toUpperCase() || "OTHERS") 
                };
            } else if (l.startsWith('http') && temp) {
                temp.url = l.trim();
                temp.isIframe = temp.url.includes('bongoflix');
                addChannel(temp.category, temp);
                temp = null;
            }
        });
    }

    function addChannel(cat, ch) {
        if (!masterData[cat]) masterData[cat] = [];
        masterData[cat].push(ch);
    }

    function renderTabs() {
        const cats = Object.keys(masterData).sort();
        document.getElementById('tabs-list').innerHTML = cats.map(c => `<button class="tab" onclick="loadCategory('${c}')" id="tab-${c}">${c}</button>`).join('');
        if (cats.length > 0) loadCategory(cats.includes('SPORTS') ? 'SPORTS' : cats[0]);
    }

    function loadCategory(cat) {
        lastActiveCategory = cat;
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        const activeTab = document.getElementById(`tab-${cat}`);
        if(activeTab) activeTab.classList.add('active');
        renderGrid(masterData[cat] || []);
    }

    function renderGrid(list) {
        const grid = document.getElementById('grid-list');
        grid.innerHTML = list.map(ch => {
            let img = (ch.logo && ch.logo.startsWith('http')) ? `<img class="ch-logo" src="${ch.logo}">` : `<span style="font-size:20px">üì∫</span>`;
            return `<div class="item" onclick='playChannel(${JSON.stringify(ch)}, this)'>${img}<div class="ch-name">${ch.name}</div></div>`;
        }).join('');
    }

    function filterChannels() {
        const query = document.getElementById('ch-search').value.toLowerCase();
        if (query === "") {
            renderGrid(masterData[lastActiveCategory] || []);
        } else {
            let filtered = [];
            Object.keys(masterData).forEach(cat => {
                masterData[cat].forEach(ch => {
                    if (ch.name.toLowerCase().includes(query)) filtered.push(ch);
                });
            });
            renderGrid(filtered);
        }
    }

    function playChannel(ch, el) {
        document.querySelectorAll('.item').forEach(i => i.classList.remove('active'));
        el.classList.add('active');
        const v = document.getElementById('vjs-player'), f = document.getElementById('iframe-player');
        
        if (currentServer === 1) {
            tvPlayer.configure({ drm: { clearKeys: ch.drm || {} } });
            tvPlayer.load(ch.url);
        } else {
            if (ch.isIframe) { 
                if(tvPlayer && tvPlayer.pause) tvPlayer.pause(); 
                v.parentElement.style.display = 'none';
                f.style.display = 'block'; f.src = ch.url; 
            } else { 
                f.style.display = 'none'; v.parentElement.style.display = 'block'; 
                tvPlayer.src({ src: ch.url, type: 'application/x-mpegURL' }); 
                tvPlayer.play(); 
            }
        }
        // ‡¶≤‡ßç‡¶Ø‡¶æ‡¶™‡¶ü‡¶™‡ßá ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶≤ ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶è‡ßú‡¶æ‡¶§‡ßá ‡¶Ö‡¶ü‡ßã ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶≤ ‡¶ï‡¶Æ‡¶ø‡ßü‡ßá ‡¶¶‡ßá‡¶ì‡ßü‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá
        // window.scrollTo({ top: 0, behavior: 'smooth' });
    }
</script>
</body>
</html>
